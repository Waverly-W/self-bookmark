/*! For license information please see options.js.LICENSE.txt */
(()=>{"use strict";var e,t={429:(e,t,r)=>{var n=r(540),o=r(338);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function i(e,t){if(e){if("string"==typeof e)return l(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach(function(t){s(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function s(e,t,r){return(t=function(e){var t=function(e){if("object"!=a(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==a(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var m={rootFolderId:"",folderTemplate:null,openaiConfig:{apiKey:"",apiUrl:"https://api.openai.com/v1",model:"gpt-4",customModel:""},isSettingsPanelOpen:!1,isOrganizePanelOpen:!1,bookmarks:[],foldersMap:new Map,organizeProgress:{isRunning:!1,currentItem:"",successCount:0,failedCount:0,percentage:0,results:[]}},f={SET_ROOT_FOLDER:"SET_ROOT_FOLDER",SET_FOLDER_TEMPLATE:"SET_FOLDER_TEMPLATE",SET_OPENAI_CONFIG:"SET_OPENAI_CONFIG",TOGGLE_SETTINGS_PANEL:"TOGGLE_SETTINGS_PANEL",TOGGLE_ORGANIZE_PANEL:"TOGGLE_ORGANIZE_PANEL",SET_BOOKMARKS:"SET_BOOKMARKS",SET_FOLDERS_MAP:"SET_FOLDERS_MAP",START_ORGANIZE:"START_ORGANIZE",STOP_ORGANIZE:"STOP_ORGANIZE",UPDATE_ORGANIZE_PROGRESS:"UPDATE_ORGANIZE_PROGRESS",ADD_ORGANIZE_RESULT:"ADD_ORGANIZE_RESULT"},p=function(e,t){var r,n,o;switch(t.type){case f.SET_ROOT_FOLDER:return u(u({},e),{},{rootFolderId:t.payload});case f.SET_FOLDER_TEMPLATE:return u(u({},e),{},{folderTemplate:t.payload});case f.SET_OPENAI_CONFIG:return u(u({},e),{},{openaiConfig:u(u({},e.openaiConfig),t.payload)});case f.TOGGLE_SETTINGS_PANEL:return u(u({},e),{},{isSettingsPanelOpen:null!==(r=t.payload)&&void 0!==r?r:!e.isSettingsPanelOpen});case f.TOGGLE_ORGANIZE_PANEL:return u(u({},e),{},{isOrganizePanelOpen:null!==(n=t.payload)&&void 0!==n?n:!e.isOrganizePanelOpen});case f.SET_BOOKMARKS:return u(u({},e),{},{bookmarks:t.payload});case f.SET_FOLDERS_MAP:return u(u({},e),{},{foldersMap:t.payload});case f.START_ORGANIZE:return u(u({},e),{},{organizeProgress:u(u({},e.organizeProgress),{},{isRunning:!0,successCount:0,failedCount:0,percentage:0,results:[]})});case f.STOP_ORGANIZE:return u(u({},e),{},{organizeProgress:u(u({},e.organizeProgress),{},{isRunning:!1})});case f.UPDATE_ORGANIZE_PROGRESS:return u(u({},e),{},{organizeProgress:u(u({},e.organizeProgress),t.payload)});case f.ADD_ORGANIZE_RESULT:return u(u({},e),{},{organizeProgress:u(u({},e.organizeProgress),{},{results:[].concat((o=e.organizeProgress.results,function(e){if(Array.isArray(e))return l(e)}(o)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(o)||i(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),[t.payload])})});default:return e}},d=(0,n.createContext)(),y=function(e){var t,r,o=e.children,a=(t=(0,n.useReducer)(p,m),r=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(t,r)||i(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l={state:a[0],dispatch:a[1],actions:f};return n.createElement(d.Provider,{value:l},o)},v=function(){var e=(0,n.useContext)(d);if(!e)throw new Error("useApp must be used within an AppProvider");return e};const b=function(){var e=v(),t=e.state,r=e.dispatch,o=e.actions;return n.createElement("header",{className:"mb-8 animate-fade-in flex justify-between items-center"},n.createElement("div",null,n.createElement("h1",{className:"text-3xl font-bold text-gray-800 mb-2"},"SelfBookmark"),n.createElement("div",{className:"h-1 w-20 bg-blue-500 rounded"})),n.createElement("div",{className:"flex space-x-4"},n.createElement("button",{onClick:function(){r({type:o.TOGGLE_ORGANIZE_PANEL})},className:"btn-primary flex items-center space-x-2 transition-all duration-300 hover:bg-blue-600 ".concat(t.isOrganizePanelOpen?"btn-secondary bg-gray-200":""),"aria-label":"智能整理"},n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})),n.createElement("span",null,"智能整理")),n.createElement("button",{onClick:function(){r({type:o.TOGGLE_SETTINGS_PANEL})},className:"btn-icon group","aria-label":"打开设置"},n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})))))};function h(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function a(r,n,o,a){var c=n&&n.prototype instanceof l?n:l,u=Object.create(c.prototype);return g(u,"_invoke",function(r,n,o){var a,l,c,u=0,s=o||[],m=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,r){return a=t,l=0,c=e,f.n=r,i}};function p(r,n){for(l=r,c=n,t=0;!m&&u&&!o&&t<s.length;t++){var o,a=s[t],p=f.p,d=a[2];r>3?(o=d===n)&&(c=a[(l=a[4])?5:(l=3,3)],a[4]=a[5]=e):a[0]<=p&&((o=r<2&&p<a[1])?(l=0,f.v=n,f.n=a[1]):p<d&&(o=r<3||a[0]>n||n>d)&&(a[4]=r,a[5]=n,f.n=d,l=0))}if(o||r>1)return i;throw m=!0,n}return function(o,s,d){if(u>1)throw TypeError("Generator is already running");for(m&&1===s&&p(s,d),l=s,c=d;(t=l<2?e:c)||!m;){a||(l?l<3?(l>1&&(f.n=-1),p(l,c)):f.n=c:f.v=c);try{if(u=2,a){if(l||(o="next"),t=a[o]){if(!(t=t.call(a,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,l<2&&(l=0)}else 1===l&&(t=a.return)&&t.call(a),l<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),l=1);a=e}else if((t=(m=f.n<0)?c:r.call(n,f))!==i)break}catch(t){a=e,l=1,c=t}finally{u=1}}return{value:t,done:m}}}(r,o,a),!0),u}var i={};function l(){}function c(){}function u(){}t=Object.getPrototypeOf;var s=[][n]?t(t([][n]())):(g(t={},n,function(){return this}),t),m=u.prototype=l.prototype=Object.create(s);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,g(e,o,"GeneratorFunction")),e.prototype=Object.create(m),e}return c.prototype=u,g(m,"constructor",u),g(u,"constructor",c),c.displayName="GeneratorFunction",g(u,o,"GeneratorFunction"),g(m),g(m,o,"Generator"),g(m,n,function(){return this}),g(m,"toString",function(){return"[object Generator]"}),(h=function(){return{w:a,m:f}})()}function g(e,t,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}g=function(e,t,r,n){function a(t,r){g(e,t,function(e){return this._invoke(t,r,e)})}t?o?o(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(a("next",0),a("throw",1),a("return",2))},g(e,t,r,n)}function E(e,t,r,n,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,o)}function w(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function i(e){E(a,n,o,i,l,"next",e)}function l(e){E(a,n,o,i,l,"throw",e)}i(void 0)})}}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return O(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?O(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var x=function(){var e=k((0,n.useState)([]),2),t=e[0],r=e[1],o=k((0,n.useState)(!0),2),a=o[0],i=o[1],l=k((0,n.useState)(null),2),c=l[0],u=l[1],s=(0,n.useCallback)(function(){return new Promise(function(e,t){"undefined"!=typeof chrome&&chrome.bookmarks?chrome.bookmarks.getTree(function(r){chrome.runtime.lastError?t(new Error(chrome.runtime.lastError.message)):e(r)}):t(new Error("Chrome bookmarks API not available"))})},[]),m=(0,n.useCallback)(function(e){return new Promise(function(t,r){"undefined"!=typeof chrome&&chrome.bookmarks?chrome.bookmarks.getSubTree(e,function(e){chrome.runtime.lastError?r(new Error(chrome.runtime.lastError.message)):t(e)}):r(new Error("Chrome bookmarks API not available"))})},[]),f=(0,n.useCallback)(function(e){return new Promise(function(t,r){"undefined"!=typeof chrome&&chrome.bookmarks?chrome.bookmarks.create(e,function(e){chrome.runtime.lastError?r(new Error(chrome.runtime.lastError.message)):t(e)}):r(new Error("Chrome bookmarks API not available"))})},[]),p=(0,n.useCallback)(function(e,t){return new Promise(function(r,n){"undefined"!=typeof chrome&&chrome.bookmarks?chrome.bookmarks.update(e,t,function(e){chrome.runtime.lastError?n(new Error(chrome.runtime.lastError.message)):r(e)}):n(new Error("Chrome bookmarks API not available"))})},[]),d=(0,n.useCallback)(function(e,t){return new Promise(function(r,n){"undefined"!=typeof chrome&&chrome.bookmarks?chrome.bookmarks.move(e,t,function(e){chrome.runtime.lastError?n(new Error(chrome.runtime.lastError.message)):r(e)}):n(new Error("Chrome bookmarks API not available"))})},[]),y=(0,n.useCallback)(function(e){return new Promise(function(t,r){"undefined"!=typeof chrome&&chrome.bookmarks?chrome.bookmarks.remove(e,function(){chrome.runtime.lastError?r(new Error(chrome.runtime.lastError.message)):t()}):r(new Error("Chrome bookmarks API not available"))})},[]),v=(0,n.useCallback)(w(h().m(function e(){var t,n,o,a=arguments;return h().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=a.length>0&&void 0!==a[0]?a[0]:"",e.p=1,i(!0),u(null),!t){e.n=3;break}return e.n=2,m(t);case 2:n=e.v,e.n=5;break;case 3:return e.n=4,s();case 4:n=e.v;case 5:r(n),e.n=7;break;case 6:e.p=6,o=e.v,u(o.message);case 7:return e.p=7,i(!1),e.f(7);case 8:return e.a(2)}},e,null,[[1,6,7,8]])})),[s,m]);return(0,n.useEffect)(function(){v()},[v]),{bookmarks:t,loading:a,error:c,loadBookmarks:v,getBookmarkTree:s,getSubTree:m,createBookmark:f,updateBookmark:p,moveBookmark:d,removeBookmark:y}};function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function N(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?N(Object(r),!0).forEach(function(t){P(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function P(e,t,r){return(t=function(e){var t=function(e){if("object"!=S(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=S(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==S(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function A(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function a(r,n,o,a){var c=n&&n.prototype instanceof l?n:l,u=Object.create(c.prototype);return T(u,"_invoke",function(r,n,o){var a,l,c,u=0,s=o||[],m=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,r){return a=t,l=0,c=e,f.n=r,i}};function p(r,n){for(l=r,c=n,t=0;!m&&u&&!o&&t<s.length;t++){var o,a=s[t],p=f.p,d=a[2];r>3?(o=d===n)&&(c=a[(l=a[4])?5:(l=3,3)],a[4]=a[5]=e):a[0]<=p&&((o=r<2&&p<a[1])?(l=0,f.v=n,f.n=a[1]):p<d&&(o=r<3||a[0]>n||n>d)&&(a[4]=r,a[5]=n,f.n=d,l=0))}if(o||r>1)return i;throw m=!0,n}return function(o,s,d){if(u>1)throw TypeError("Generator is already running");for(m&&1===s&&p(s,d),l=s,c=d;(t=l<2?e:c)||!m;){a||(l?l<3?(l>1&&(f.n=-1),p(l,c)):f.n=c:f.v=c);try{if(u=2,a){if(l||(o="next"),t=a[o]){if(!(t=t.call(a,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,l<2&&(l=0)}else 1===l&&(t=a.return)&&t.call(a),l<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),l=1);a=e}else if((t=(m=f.n<0)?c:r.call(n,f))!==i)break}catch(t){a=e,l=1,c=t}finally{u=1}}return{value:t,done:m}}}(r,o,a),!0),u}var i={};function l(){}function c(){}function u(){}t=Object.getPrototypeOf;var s=[][n]?t(t([][n]())):(T(t={},n,function(){return this}),t),m=u.prototype=l.prototype=Object.create(s);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,T(e,o,"GeneratorFunction")),e.prototype=Object.create(m),e}return c.prototype=u,T(m,"constructor",u),T(u,"constructor",c),c.displayName="GeneratorFunction",T(u,o,"GeneratorFunction"),T(m),T(m,o,"Generator"),T(m,n,function(){return this}),T(m,"toString",function(){return"[object Generator]"}),(A=function(){return{w:a,m:f}})()}function T(e,t,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}T=function(e,t,r,n){function a(t,r){T(e,t,function(e){return this._invoke(t,r,e)})}t?o?o(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(a("next",0),a("throw",1),a("return",2))},T(e,t,r,n)}function C(e,t,r,n,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,o)}function _(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function i(e){C(a,n,o,i,l,"next",e)}function l(e){C(a,n,o,i,l,"throw",e)}i(void 0)})}}function I(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return L(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?L(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=I((0,n.useState)({}),2),r=t[0],o=t[1],a=I((0,n.useState)(!0),2),i=a[0],l=a[1],c=I((0,n.useState)(null),2),u=c[0],s=c[1],m=(0,n.useCallback)(function(e){return new Promise(function(t,r){"undefined"!=typeof chrome&&chrome.storage?chrome.storage.local.get(e,function(e){chrome.runtime.lastError?r(new Error(chrome.runtime.lastError.message)):t(e)}):r(new Error("Chrome storage API not available"))})},[]),f=(0,n.useCallback)(function(e){return new Promise(function(t,r){"undefined"!=typeof chrome&&chrome.storage?chrome.storage.local.set(e,function(){chrome.runtime.lastError?r(new Error(chrome.runtime.lastError.message)):t()}):r(new Error("Chrome storage API not available"))})},[]),p=(0,n.useCallback)(function(e){return new Promise(function(t,r){"undefined"!=typeof chrome&&chrome.storage?chrome.storage.local.remove(e,function(){chrome.runtime.lastError?r(new Error(chrome.runtime.lastError.message)):t()}):r(new Error("Chrome storage API not available"))})},[]),d=(0,n.useCallback)(function(){return new Promise(function(e,t){"undefined"!=typeof chrome&&chrome.storage?chrome.storage.local.clear(function(){chrome.runtime.lastError?t(new Error(chrome.runtime.lastError.message)):e()}):t(new Error("Chrome storage API not available"))})},[]),y=(0,n.useCallback)(_(A().m(function t(){var r,n,a,i=arguments;return A().w(function(t){for(;;)switch(t.p=t.n){case 0:return r=i.length>0&&void 0!==i[0]?i[0]:e,t.p=1,l(!0),s(null),t.n=2,m(r);case 2:n=t.v,o(n),t.n=4;break;case 3:t.p=3,a=t.v,s(a.message);case 4:return t.p=4,l(!1),t.f(4);case 5:return t.a(2)}},t,null,[[1,3,4,5]])})),[m,e]),v=(0,n.useCallback)(function(){var e=_(A().m(function e(t){var r;return A().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,s(null),e.n=1,f(t);case 1:o(function(e){return j(j({},e),t)}),e.n=3;break;case 2:throw e.p=2,r=e.v,s(r.message),r;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t){return e.apply(this,arguments)}}(),[f]);return(0,n.useEffect)(function(){e?y():l(!1)},[y,e]),{data:r,loading:i,error:u,get:m,set:v,remove:p,clear:d,reload:y}};const R=function(e){var t=e.bookmark;return e.level,n.createElement("div",{className:"bookmark-item"},n.createElement("svg",{className:"bookmark-icon",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})),n.createElement("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"flex-1"},t.title))};function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var F=function(e){var t,r,o=e.folder,a=e.level,i=void 0===a?0:a,l=(t=(0,n.useState)(!1),r=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(t,r)||function(e,t){if(e){if("string"==typeof e)return M(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?M(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=l[0],u=l[1];return n.createElement("div",{className:"folder"},n.createElement("div",{className:"folder-title",onClick:function(){u(!c)}},n.createElement("svg",{className:"folder-title-icon ".concat(c?"rotate-90":""),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})),n.createElement("svg",{className:"w-5 h-5 mr-2 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})),n.createElement("span",null,o.title)),n.createElement("div",{className:"folder-content ".concat(c?"":"h-0"),"data-state":c?"open":"closed"},c&&(o.children&&0!==o.children.length?o.children.map(function(e){return e.children?n.createElement(F,{key:e.id,folder:e,level:i+1}):n.createElement(R,{key:e.id,bookmark:e,level:i+1})}):null)))};const z=F;function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const B=function(){var e,t,r=v().state,o=x(),a=o.bookmarks,i=o.loading,l=o.error,c=o.loadBookmarks,u=G(["rootFolderId"]).data,s=(e=(0,n.useState)([]),t=2,function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return D(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?D(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),m=s[0],f=s[1];return(0,n.useEffect)(function(){var e=u.rootFolderId||r.rootFolderId;c(e)},[u.rootFolderId,r.rootFolderId,c]),(0,n.useEffect)(function(){if(a.length>0)if(u.rootFolderId){var e=a[0];f((null==e?void 0:e.children)||[])}else{var t;f((null===(t=a[0])||void 0===t?void 0:t.children)||[])}},[a,u.rootFolderId]),i?n.createElement("div",{className:"card animate-fade-in"},n.createElement("div",{className:"flex items-center justify-center py-8"},n.createElement("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),n.createElement("span",{className:"ml-2 text-gray-600"},"加载书签中..."))):l?n.createElement("div",{className:"card animate-fade-in"},n.createElement("div",{className:"text-center py-8"},n.createElement("div",{className:"text-red-500 mb-2"},n.createElement("svg",{className:"w-12 h-12 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"}))),n.createElement("p",{className:"text-gray-600"},"加载书签时出错: ",l))):n.createElement("div",{className:"card animate-fade-in ".concat(r.isOrganizePanelOpen?"hidden":"")},n.createElement("div",{className:"hidden"},n.createElement("svg",{id:"folder-icon",className:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})),n.createElement("svg",{id:"chevron-icon",className:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})),n.createElement("svg",{id:"bookmark-icon",className:"w-4 h-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"}))),0===m.length?n.createElement("div",{className:"text-center py-8"},n.createElement("div",{className:"text-gray-400 mb-2"},n.createElement("svg",{className:"w-12 h-12 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"}))),n.createElement("p",{className:"text-gray-500"},"暂无书签")):n.createElement("div",{className:"space-y-1"},m.map(function(e){return e.children?n.createElement(z,{key:e.id,folder:e,onToggle:function(){}}):n.createElement(R,{key:e.id,bookmark:e})})))};function U(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function a(r,n,o,a){var c=n&&n.prototype instanceof l?n:l,u=Object.create(c.prototype);return W(u,"_invoke",function(r,n,o){var a,l,c,u=0,s=o||[],m=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,r){return a=t,l=0,c=e,f.n=r,i}};function p(r,n){for(l=r,c=n,t=0;!m&&u&&!o&&t<s.length;t++){var o,a=s[t],p=f.p,d=a[2];r>3?(o=d===n)&&(c=a[(l=a[4])?5:(l=3,3)],a[4]=a[5]=e):a[0]<=p&&((o=r<2&&p<a[1])?(l=0,f.v=n,f.n=a[1]):p<d&&(o=r<3||a[0]>n||n>d)&&(a[4]=r,a[5]=n,f.n=d,l=0))}if(o||r>1)return i;throw m=!0,n}return function(o,s,d){if(u>1)throw TypeError("Generator is already running");for(m&&1===s&&p(s,d),l=s,c=d;(t=l<2?e:c)||!m;){a||(l?l<3?(l>1&&(f.n=-1),p(l,c)):f.n=c:f.v=c);try{if(u=2,a){if(l||(o="next"),t=a[o]){if(!(t=t.call(a,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,l<2&&(l=0)}else 1===l&&(t=a.return)&&t.call(a),l<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),l=1);a=e}else if((t=(m=f.n<0)?c:r.call(n,f))!==i)break}catch(t){a=e,l=1,c=t}finally{u=1}}return{value:t,done:m}}}(r,o,a),!0),u}var i={};function l(){}function c(){}function u(){}t=Object.getPrototypeOf;var s=[][n]?t(t([][n]())):(W(t={},n,function(){return this}),t),m=u.prototype=l.prototype=Object.create(s);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,W(e,o,"GeneratorFunction")),e.prototype=Object.create(m),e}return c.prototype=u,W(m,"constructor",u),W(u,"constructor",c),c.displayName="GeneratorFunction",W(u,o,"GeneratorFunction"),W(m),W(m,o,"Generator"),W(m,n,function(){return this}),W(m,"toString",function(){return"[object Generator]"}),(U=function(){return{w:a,m:f}})()}function W(e,t,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}W=function(e,t,r,n){function a(t,r){W(e,t,function(e){return this._invoke(t,r,e)})}t?o?o(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(a("next",0),a("throw",1),a("return",2))},W(e,t,r,n)}function Z(e,t,r,n,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,o)}function V(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return K(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?K(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const H=function(e){var t=e.value,r=e.onChange,o=x().getBookmarkTree,a=V((0,n.useState)([]),2),i=a[0],l=a[1],c=V((0,n.useState)(!0),2),u=c[0],s=c[1];(0,n.useEffect)(function(){m()},[]);var m=function(){var e,t=(e=U().m(function e(){var t,r,n,a;return U().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,s(!0),e.n=1,o();case 1:t=e.v,r=[],n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(e.children){if("0"!==e.id){var o="　".repeat(t),a=0===t?"📁":"└─ 📁";r.push({id:e.id,title:e.title,displayText:"".concat(o).concat(a," ").concat(e.title),level:t})}e.children.forEach(function(e){return n(e,t+1)})}},t.forEach(function(e){return n(e)}),l(r),e.n=3;break;case 2:e.p=2,a=e.v,console.error("加载文件夹失败:",a);case 3:return e.p=3,s(!1),e.f(3);case 4:return e.a(2)}},e,null,[[0,2,3,4]])}),function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function i(e){Z(a,n,o,i,l,"next",e)}function l(e){Z(a,n,o,i,l,"throw",e)}i(void 0)})});return function(){return t.apply(this,arguments)}}();return n.createElement("div",{className:"mb-6"},n.createElement("h3",{className:"text-sm font-medium text-gray-700 mb-2"},"根文件夹设置"),n.createElement("div",{className:"border rounded-lg p-4 bg-white"},n.createElement("div",{className:"flex flex-col space-y-2"},n.createElement("div",{className:"flex items-center space-x-2"},n.createElement("svg",{className:"w-5 h-5 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})),n.createElement("span",{className:"text-sm text-gray-600"},"选择要显示的根文件夹")),n.createElement("div",{className:"relative"},n.createElement("select",{value:t,onChange:function(e){return r(e.target.value)},className:"select-field appearance-none bg-gray-50 hover:bg-gray-100 transition-colors duration-200",disabled:u},u?n.createElement("option",{value:""},"加载中..."):n.createElement(n.Fragment,null,n.createElement("option",{value:"",className:"py-3 font-medium"},"📚 显示所有书签"),n.createElement("option",{disabled:!0,className:"text-gray-300 text-center"},"──────────"),i.map(function(e){return n.createElement("option",{key:e.id,value:e.id,className:"py-1.5 ".concat(0===e.level?"font-medium":"font-normal")},e.displayText)}))),n.createElement("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-500"},n.createElement("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},n.createElement("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})))))))};function $(e){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$(e)}function J(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?J(Object(r),!0).forEach(function(t){Q(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Q(e,t,r){return(t=function(e){var t=function(e){if("object"!=$(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=$(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==$(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function X(e){return function(e){if(Array.isArray(e))return ee(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Y(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Y(e,t){if(e){if("string"==typeof e)return ee(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ee(e,t):void 0}}function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const te=function(e){var t,r,o=e.template,a=e.onChange,i=(t=(0,n.useState)(o||[]),r=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(t,r)||Y(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=i[0],c=i[1],u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return n.createElement("div",{key:e.id,className:"ml-".concat(4*t," border-l-2 border-gray-200 pl-4 py-2")},n.createElement("div",{className:"flex items-center space-x-2"},n.createElement("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})),n.createElement("input",{type:"text",value:e.name,onChange:function(t){return r=e.id,n={name:t.target.value},i=(o=function(e){return e.map(function(e){return e.id===r?q(q({},e),n):(e.children&&(e.children=o(e.children)),e)})})(X(l)),c(i),void a(i);var r,n,o,i},className:"flex-1 text-sm border-none bg-transparent focus:outline-none focus:bg-gray-50 rounded px-2 py-1"}),n.createElement("button",{onClick:function(){return t=e.id,r={id:Date.now().toString(),name:"新子文件夹",children:[]},o=(n=function(e){return e.map(function(e){return e.id===t?q(q({},e),{},{children:[].concat(X(e.children||[]),[r])}):(e.children&&(e.children=n(e.children)),e)})})(X(l)),c(o),void a(o);var t,r,n,o},className:"text-xs text-blue-600 hover:text-blue-800",title:"添加子文件夹"},"+"),n.createElement("button",{onClick:function(){return t=e.id,n=(r=function(e){return e.filter(function(e){return e.id!==t&&(e.children&&(e.children=r(e.children)),!0)})})(X(l)),c(n),void a(n);var t,r,n},className:"text-xs text-red-600 hover:text-red-800",title:"删除文件夹"},"×")),e.children&&e.children.map(function(e){return u(e,t+1)}))};return n.createElement("div",{className:"mb-6"},n.createElement("h3",{className:"text-sm font-medium text-gray-700 mb-2"},"文件夹模板设置"),n.createElement("div",{className:"border rounded-lg p-4 bg-white"},n.createElement("div",{className:"flex justify-between items-center mb-4"},n.createElement("div",{className:"flex space-x-2"},n.createElement("button",{onClick:function(){var e={id:Date.now().toString(),name:"新文件夹",children:[]},t=[].concat(X(l),[e]);c(t),a(t)},className:"btn-secondary text-sm"},"添加根文件夹"))),n.createElement("div",{className:"space-y-2 max-h-64 overflow-y-auto"},0===l.length?n.createElement("div",{className:"text-center py-4 text-gray-500"},'暂无文件夹模板，点击"添加根文件夹"开始创建'):l.map(function(e){return u(e)}))))};function re(e){return re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},re(e)}function ne(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function a(r,n,o,a){var c=n&&n.prototype instanceof l?n:l,u=Object.create(c.prototype);return oe(u,"_invoke",function(r,n,o){var a,l,c,u=0,s=o||[],m=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,r){return a=t,l=0,c=e,f.n=r,i}};function p(r,n){for(l=r,c=n,t=0;!m&&u&&!o&&t<s.length;t++){var o,a=s[t],p=f.p,d=a[2];r>3?(o=d===n)&&(c=a[(l=a[4])?5:(l=3,3)],a[4]=a[5]=e):a[0]<=p&&((o=r<2&&p<a[1])?(l=0,f.v=n,f.n=a[1]):p<d&&(o=r<3||a[0]>n||n>d)&&(a[4]=r,a[5]=n,f.n=d,l=0))}if(o||r>1)return i;throw m=!0,n}return function(o,s,d){if(u>1)throw TypeError("Generator is already running");for(m&&1===s&&p(s,d),l=s,c=d;(t=l<2?e:c)||!m;){a||(l?l<3?(l>1&&(f.n=-1),p(l,c)):f.n=c:f.v=c);try{if(u=2,a){if(l||(o="next"),t=a[o]){if(!(t=t.call(a,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,l<2&&(l=0)}else 1===l&&(t=a.return)&&t.call(a),l<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),l=1);a=e}else if((t=(m=f.n<0)?c:r.call(n,f))!==i)break}catch(t){a=e,l=1,c=t}finally{u=1}}return{value:t,done:m}}}(r,o,a),!0),u}var i={};function l(){}function c(){}function u(){}t=Object.getPrototypeOf;var s=[][n]?t(t([][n]())):(oe(t={},n,function(){return this}),t),m=u.prototype=l.prototype=Object.create(s);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,oe(e,o,"GeneratorFunction")),e.prototype=Object.create(m),e}return c.prototype=u,oe(m,"constructor",u),oe(u,"constructor",c),c.displayName="GeneratorFunction",oe(u,o,"GeneratorFunction"),oe(m),oe(m,o,"Generator"),oe(m,n,function(){return this}),oe(m,"toString",function(){return"[object Generator]"}),(ne=function(){return{w:a,m:f}})()}function oe(e,t,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}oe=function(e,t,r,n){function a(t,r){oe(e,t,function(e){return this._invoke(t,r,e)})}t?o?o(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(a("next",0),a("throw",1),a("return",2))},oe(e,t,r,n)}function ae(e,t,r,n,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,o)}function ie(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return le(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?le(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function le(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const ce=function(e){var t=e.config,r=e.onChange,o=ie((0,n.useState)(!1),2),a=o[0],i=o[1],l=ie((0,n.useState)(!1),2),c=l[0],u=l[1],s=ie((0,n.useState)(null),2),m=s[0],f=s[1],p=function(e,t){var n,o,a;r((n={},a=t,(o=function(e){var t=function(e){if("object"!=re(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=re(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==re(t)?t:t+""}(o=e))in n?Object.defineProperty(n,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[o]=a,n))},d=function(){var e,r=(e=ne().m(function e(){var r,n,o,a,i,l;return ne().w(function(e){for(;;)switch(e.p=e.n){case 0:if(u(!0),f(null),e.p=1,r=t.apiUrl||"https://api.openai.com/v1",n="custom"===t.model?t.customModel:t.model,t.apiKey){e.n=2;break}throw new Error("请先输入API Key");case 2:if(n){e.n=3;break}throw new Error("请选择或输入模型名称");case 3:return e.n=4,fetch("".concat(r,"/chat/completions"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.apiKey)},body:JSON.stringify({model:n,messages:[{role:"user",content:"Hello"}],max_tokens:5})});case 4:if(!(o=e.v).ok){e.n=5;break}f({success:!0,message:"连接成功"}),e.n=7;break;case 5:return e.n=6,o.json();case 6:throw i=e.v,new Error((null===(a=i.error)||void 0===a?void 0:a.message)||"连接失败");case 7:e.n=9;break;case 8:e.p=8,l=e.v,f({success:!1,message:l.message});case 9:return e.p=9,u(!1),e.f(9);case 10:return e.a(2)}},e,null,[[1,8,9,10]])}),function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function i(e){ae(a,n,o,i,l,"next",e)}function l(e){ae(a,n,o,i,l,"throw",e)}i(void 0)})});return function(){return r.apply(this,arguments)}}();return n.createElement("div",{className:"mb-6"},n.createElement("h3",{className:"text-sm font-medium text-gray-700 mb-2"},"OpenAI API 设置"),n.createElement("div",{className:"border rounded-lg p-4 bg-white space-y-4"},n.createElement("div",null,n.createElement("label",{htmlFor:"openaiApiKey",className:"block text-sm font-medium text-gray-700 mb-1"},"API Key"),n.createElement("div",{className:"relative"},n.createElement("input",{type:a?"text":"password",id:"openaiApiKey",value:t.apiKey||"",onChange:function(e){return p("apiKey",e.target.value)},className:"input-field pr-10",placeholder:"输入你的 OpenAI API Key"}),n.createElement("button",{type:"button",onClick:function(){return i(!a)},className:"absolute inset-y-0 right-0 px-3 flex items-center text-gray-500 hover:text-gray-700"},n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"}))))),n.createElement("div",null,n.createElement("label",{htmlFor:"openaiApiUrl",className:"block text-sm font-medium text-gray-700 mb-1"},"API URL"),n.createElement("input",{type:"url",id:"openaiApiUrl",value:t.apiUrl||"https://api.openai.com/v1",onChange:function(e){return p("apiUrl",e.target.value)},className:"input-field",placeholder:"https://api.openai.com/v1"})),n.createElement("div",null,n.createElement("label",{htmlFor:"openaiModel",className:"block text-sm font-medium text-gray-700 mb-1"},"模型选择"),n.createElement("div",{className:"space-y-2"},n.createElement("div",{className:"relative"},n.createElement("select",{id:"openaiModel",value:t.model||"gpt-4",onChange:function(e){var t=e.target.value;p("model",t),"custom"===t||p("customModel","")},className:"select-field appearance-none"},n.createElement("option",{value:"gpt-4"},"GPT-4"),n.createElement("option",{value:"gpt-4-turbo-preview"},"GPT-4 Turbo"),n.createElement("option",{value:"gpt-3.5-turbo"},"GPT-3.5 Turbo"),n.createElement("option",{value:"custom"},"自定义模型")),n.createElement("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-500"},n.createElement("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},n.createElement("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})))),"custom"===t.model&&n.createElement("div",null,n.createElement("input",{type:"text",value:t.customModel||"",onChange:function(e){return p("customModel",e.target.value)},className:"input-field",placeholder:"输入自定义模型名称，例如: gpt-4-32k"})))),n.createElement("div",{className:"pt-2"},n.createElement("div",{className:"flex items-center space-x-2"},n.createElement("button",{onClick:d,disabled:c,className:"btn-secondary text-sm flex items-center space-x-1"},c?n.createElement("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},n.createElement("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),n.createElement("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})):n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})),n.createElement("span",null,c?"测试中...":"测试连接")),m&&n.createElement("div",{className:"flex items-center space-x-1"},m.success?n.createElement("svg",{className:"h-4 w-4 text-green-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})):n.createElement("svg",{className:"h-4 w-4 text-red-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})),n.createElement("span",{className:"text-sm ".concat(m.success?"text-green-600":"text-red-600")},m.message))))))};function ue(e){return ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ue(e)}function se(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function a(r,n,o,a){var c=n&&n.prototype instanceof l?n:l,u=Object.create(c.prototype);return me(u,"_invoke",function(r,n,o){var a,l,c,u=0,s=o||[],m=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,r){return a=t,l=0,c=e,f.n=r,i}};function p(r,n){for(l=r,c=n,t=0;!m&&u&&!o&&t<s.length;t++){var o,a=s[t],p=f.p,d=a[2];r>3?(o=d===n)&&(c=a[(l=a[4])?5:(l=3,3)],a[4]=a[5]=e):a[0]<=p&&((o=r<2&&p<a[1])?(l=0,f.v=n,f.n=a[1]):p<d&&(o=r<3||a[0]>n||n>d)&&(a[4]=r,a[5]=n,f.n=d,l=0))}if(o||r>1)return i;throw m=!0,n}return function(o,s,d){if(u>1)throw TypeError("Generator is already running");for(m&&1===s&&p(s,d),l=s,c=d;(t=l<2?e:c)||!m;){a||(l?l<3?(l>1&&(f.n=-1),p(l,c)):f.n=c:f.v=c);try{if(u=2,a){if(l||(o="next"),t=a[o]){if(!(t=t.call(a,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,l<2&&(l=0)}else 1===l&&(t=a.return)&&t.call(a),l<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),l=1);a=e}else if((t=(m=f.n<0)?c:r.call(n,f))!==i)break}catch(t){a=e,l=1,c=t}finally{u=1}}return{value:t,done:m}}}(r,o,a),!0),u}var i={};function l(){}function c(){}function u(){}t=Object.getPrototypeOf;var s=[][n]?t(t([][n]())):(me(t={},n,function(){return this}),t),m=u.prototype=l.prototype=Object.create(s);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,me(e,o,"GeneratorFunction")),e.prototype=Object.create(m),e}return c.prototype=u,me(m,"constructor",u),me(u,"constructor",c),c.displayName="GeneratorFunction",me(u,o,"GeneratorFunction"),me(m),me(m,o,"Generator"),me(m,n,function(){return this}),me(m,"toString",function(){return"[object Generator]"}),(se=function(){return{w:a,m:f}})()}function me(e,t,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}me=function(e,t,r,n){function a(t,r){me(e,t,function(e){return this._invoke(t,r,e)})}t?o?o(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(a("next",0),a("throw",1),a("return",2))},me(e,t,r,n)}function fe(e,t,r,n,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,o)}function pe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function de(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(r),!0).forEach(function(t){ye(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pe(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function ye(e,t,r){return(t=function(e){var t=function(e){if("object"!=ue(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=ue(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ue(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const be=function(){var e,t,r=v(),o=r.state,a=r.dispatch,i=r.actions,l=G(),c=l.data,u=l.set,s=(e=(0,n.useState)({rootFolderId:"",folderTemplate:null,openaiConfig:{apiKey:"",apiUrl:"https://api.openai.com/v1",model:"gpt-4",customModel:""}}),t=2,function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ve(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ve(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),m=s[0],f=s[1];(0,n.useEffect)(function(){c&&f(function(e){return de(de({},e),{},{rootFolderId:c.rootFolderId||"",folderTemplate:c.folderTemplate||null,openaiConfig:de(de({},e.openaiConfig),c.openaiConfig)})})},[c]);var p=function(){a({type:i.TOGGLE_SETTINGS_PANEL,payload:!1})},d=function(){var e,t=(e=se().m(function e(){var t;return se().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,u({rootFolderId:m.rootFolderId,folderTemplate:m.folderTemplate,openaiConfig:m.openaiConfig});case 1:a({type:i.SET_ROOT_FOLDER,payload:m.rootFolderId}),a({type:i.SET_FOLDER_TEMPLATE,payload:m.folderTemplate}),a({type:i.SET_OPENAI_CONFIG,payload:m.openaiConfig}),y("设置保存成功","success"),p(),e.n=3;break;case 2:e.p=2,t=e.v,y("保存设置失败: "+t.message,"error");case 3:return e.a(2)}},e,null,[[0,2]])}),function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function i(e){fe(a,n,o,i,l,"next",e)}function l(e){fe(a,n,o,i,l,"throw",e)}i(void 0)})});return function(){return t.apply(this,arguments)}}(),y=function(e,t){console.log("".concat(t,": ").concat(e))},b=function(e,t){f(function(r){return de(de({},r),{},ye({},e,t))})};return n.createElement("div",{className:"fixed right-0 top-0 h-full w-1/3 bg-white shadow-2xl transform transition-transform duration-300 z-50 flex flex-col ".concat(o.isSettingsPanelOpen?"translate-x-0":"translate-x-full")},n.createElement("div",{className:"flex-1 overflow-y-auto"},n.createElement("div",{className:"p-6"},n.createElement("div",{className:"flex justify-between items-center mb-6"},n.createElement("h2",{className:"text-xl font-semibold text-gray-800"},"设置")),n.createElement("div",{className:"space-y-6"},n.createElement(H,{value:m.rootFolderId,onChange:function(e){return b("rootFolderId",e)}}),n.createElement(te,{template:m.folderTemplate,onChange:function(e){return b("folderTemplate",e)}}),n.createElement(ce,{config:m.openaiConfig,onChange:function(e){f(function(t){return de(de({},t),{},{openaiConfig:de(de({},t.openaiConfig),e)})})}})))),n.createElement("div",{className:"p-6 bg-gray-50 border-t"},n.createElement("div",{className:"flex space-x-4"},n.createElement("button",{onClick:p,className:"btn-secondary flex-1"},"取消"),n.createElement("button",{onClick:d,className:"btn-primary flex-1"},"保存设置"))))},he=function(e){var t=e.template,r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return n.createElement("div",{key:e.id,className:"ml-".concat(6*t," py-1")},n.createElement("div",{className:"flex items-center space-x-2 p-2 hover:bg-gray-50 rounded-lg"},n.createElement("svg",{className:"w-5 h-5 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})),n.createElement("span",{className:"text-gray-700 font-medium"},e.name)),e.children&&e.children.length>0&&n.createElement("div",{className:"ml-4"},e.children.map(function(e){return r(e,t+1)})))};return t&&0!==t.length?n.createElement("div",{className:"space-y-1"},t.map(function(e){return r(e)})):n.createElement("div",{className:"text-center py-8 text-gray-500"},n.createElement("svg",{className:"w-12 h-12 mx-auto mb-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})),n.createElement("p",null,"暂无文件夹模板"))};function ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Ee=function(){var e,t,r=v().state,o=(e=(0,n.useState)(!1),t=2,function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ge(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ge(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=o[0],i=o[1],l=r.organizeProgress;return l.isRunning||0!==l.results.length?n.createElement("div",{className:"mt-6 transition-all duration-300 ease-in-out"},n.createElement("div",{className:"card p-0"},n.createElement("div",{className:"flex items-center justify-between cursor-pointer hover:bg-gray-50 p-3 rounded-t-lg transition-colors duration-200 min-h-[64px]",onClick:function(){i(!a)}},n.createElement("div",{className:"flex items-center space-x-4"},n.createElement("span",{className:"text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-blue-600 bg-blue-200"},"处理进度"),n.createElement("div",{className:"flex items-center space-x-2"},l.isRunning&&n.createElement("svg",{className:"w-4 h-4 text-blue-500 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},n.createElement("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),n.createElement("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})),!l.isRunning&&l.results.length>0&&n.createElement("svg",{className:"w-4 h-4 text-green-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})),n.createElement("span",{className:"text-sm text-gray-700"},n.createElement("span",{className:"font-medium"},l.isRunning?l.currentItem||"准备开始...":"处理完成")))),n.createElement("div",{className:"flex items-center space-x-4"},n.createElement("div",{className:"text-sm"},n.createElement("span",{className:"text-green-600"},"成功: ",l.successCount),n.createElement("span",{className:"mx-2 text-gray-300"},"|"),n.createElement("span",{className:"text-red-600"},"失败: ",l.failedCount),n.createElement("span",{className:"ml-2"},"(",l.percentage,"%)")),n.createElement("svg",{className:"w-5 h-5 transform transition-transform duration-200 ".concat(a?"rotate-180":""),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})))),a&&n.createElement("div",{className:"border-t transition-all duration-300 ease-in-out"},n.createElement("div",{className:"p-4"},n.createElement("div",{className:"text-sm text-gray-600 mb-2"},"处理历史:"),n.createElement("div",{className:"space-y-2 overflow-y-auto max-h-64"},0===l.results.length?n.createElement("div",{className:"text-center py-4 text-gray-500"},"暂无处理记录"):l.results.map(function(e,t){return n.createElement("div",{key:t,className:"p-2 rounded text-sm ".concat(e.success?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200")},n.createElement("div",{className:"flex items-center space-x-2"},e.success?n.createElement("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})):n.createElement("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})),n.createElement("span",{className:"font-medium"},e.item)),e.message&&n.createElement("div",{className:"mt-1 text-xs opacity-75"},e.message))})),l.isRunning&&n.createElement("div",{className:"flex justify-end space-x-2 pt-4 mt-4 border-t"},n.createElement("button",{className:"btn-secondary text-sm flex items-center space-x-1",onClick:function(){console.log("停止整理")}},n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})),n.createElement("span",null,"停止整理"))))))):null};function we(e){return we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},we(e)}function ke(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Oe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ke(Object(r),!0).forEach(function(t){xe(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ke(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function xe(e,t,r){return(t=function(e){var t=function(e){if("object"!=we(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=we(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==we(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Se(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Ne=function(e){e.onClose;var t,r,o=e.hasTemplate,a=v(),i=a.state,l=a.dispatch,c=a.actions,u=(t=(0,n.useState)({renameBookmarks:!1,moveToTargetFolders:!1}),r=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(t,r)||function(e,t){if(e){if("string"==typeof e)return Se(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Se(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=u[0],m=u[1],f=function(e,t){m(function(r){return Oe(Oe({},r),{},xe({},e,t))})};return n.createElement("div",{className:"mt-6 flex justify-end space-x-4"},n.createElement("div",{className:"flex items-center space-x-4"},n.createElement("div",{className:"flex items-center space-x-2"},n.createElement("input",{type:"checkbox",id:"renameOption",checked:s.renameBookmarks,onChange:function(e){return f("renameBookmarks",e.target.checked)},className:"form-checkbox h-4 w-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"}),n.createElement("label",{htmlFor:"renameOption",className:"text-sm text-gray-700"},"重命名书签")),n.createElement("div",{className:"flex items-center space-x-2"},n.createElement("input",{type:"checkbox",id:"moveOption",checked:s.moveToTargetFolders,onChange:function(e){return f("moveToTargetFolders",e.target.checked)},className:"form-checkbox h-4 w-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"}),n.createElement("label",{htmlFor:"moveOption",className:"text-sm text-gray-700"},"移动到目标文件夹")),n.createElement("button",{onClick:function(){var e,t,r,n,a;o?(l({type:c.START_ORGANIZE}),console.log("开始整理，选项:",s),e=["工作相关","学习资料","娱乐网站","购物网站","新闻资讯"],t=0,r=0,n=0,(a=function(){if(t>=e.length)return l({type:c.STOP_ORGANIZE}),void l({type:c.UPDATE_ORGANIZE_PROGRESS,payload:{currentItem:"处理完成",percentage:100}});var o=e[t],i=Math.random()>.2;l({type:c.UPDATE_ORGANIZE_PROGRESS,payload:{currentItem:"正在处理: ".concat(o),percentage:Math.round((t+1)/e.length*100)}}),setTimeout(function(){i?(r++,l({type:c.ADD_ORGANIZE_RESULT,payload:{item:o,success:!0,message:"成功移动到目标文件夹"}})):(n++,l({type:c.ADD_ORGANIZE_RESULT,payload:{item:o,success:!1,message:"无法确定合适的文件夹"}})),l({type:c.UPDATE_ORGANIZE_PROGRESS,payload:{successCount:r,failedCount:n}}),t++,a()},1e3+2e3*Math.random())})()):alert("请先配置文件夹模板")},disabled:i.organizeProgress.isRunning||!o,className:"btn-primary flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"},n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})),n.createElement("span",null,i.organizeProgress.isRunning?"整理中...":"开始整理"))),n.createElement("button",{onClick:function(){console.log("应用变更"),l({type:c.UPDATE_ORGANIZE_PROGRESS,payload:{isRunning:!1,currentItem:"",successCount:0,failedCount:0,percentage:0,results:[]}})},disabled:i.organizeProgress.isRunning||0===i.organizeProgress.results.length,className:"btn-primary flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"},n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})),n.createElement("span",null,"应用变更")))};function je(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function a(r,n,o,a){var c=n&&n.prototype instanceof l?n:l,u=Object.create(c.prototype);return Pe(u,"_invoke",function(r,n,o){var a,l,c,u=0,s=o||[],m=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,r){return a=t,l=0,c=e,f.n=r,i}};function p(r,n){for(l=r,c=n,t=0;!m&&u&&!o&&t<s.length;t++){var o,a=s[t],p=f.p,d=a[2];r>3?(o=d===n)&&(c=a[(l=a[4])?5:(l=3,3)],a[4]=a[5]=e):a[0]<=p&&((o=r<2&&p<a[1])?(l=0,f.v=n,f.n=a[1]):p<d&&(o=r<3||a[0]>n||n>d)&&(a[4]=r,a[5]=n,f.n=d,l=0))}if(o||r>1)return i;throw m=!0,n}return function(o,s,d){if(u>1)throw TypeError("Generator is already running");for(m&&1===s&&p(s,d),l=s,c=d;(t=l<2?e:c)||!m;){a||(l?l<3?(l>1&&(f.n=-1),p(l,c)):f.n=c:f.v=c);try{if(u=2,a){if(l||(o="next"),t=a[o]){if(!(t=t.call(a,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,l<2&&(l=0)}else 1===l&&(t=a.return)&&t.call(a),l<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),l=1);a=e}else if((t=(m=f.n<0)?c:r.call(n,f))!==i)break}catch(t){a=e,l=1,c=t}finally{u=1}}return{value:t,done:m}}}(r,o,a),!0),u}var i={};function l(){}function c(){}function u(){}t=Object.getPrototypeOf;var s=[][n]?t(t([][n]())):(Pe(t={},n,function(){return this}),t),m=u.prototype=l.prototype=Object.create(s);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,Pe(e,o,"GeneratorFunction")),e.prototype=Object.create(m),e}return c.prototype=u,Pe(m,"constructor",u),Pe(u,"constructor",c),c.displayName="GeneratorFunction",Pe(u,o,"GeneratorFunction"),Pe(m),Pe(m,o,"Generator"),Pe(m,n,function(){return this}),Pe(m,"toString",function(){return"[object Generator]"}),(je=function(){return{w:a,m:f}})()}function Pe(e,t,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Pe=function(e,t,r,n){function a(t,r){Pe(e,t,function(e){return this._invoke(t,r,e)})}t?o?o(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(a("next",0),a("throw",1),a("return",2))},Pe(e,t,r,n)}function Ae(e,t,r,n,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,o)}function Te(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ce(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ce(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const _e=function(){var e=v(),t=e.state,r=e.dispatch,o=e.actions,a=x(),i=a.bookmarks,l=a.loadBookmarks,c=G(["folderTemplate"]).data,u=Te((0,n.useState)([]),2),s=u[0],m=u[1],f=Te((0,n.useState)(null),2),p=f[0],d=f[1];(0,n.useEffect)(function(){t.isOrganizePanelOpen&&y()},[t.isOrganizePanelOpen]);var y=function(){var e,t=(e=je().m(function e(){var t;return je().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,l();case 1:m(i),c.folderTemplate&&d(c.folderTemplate),e.n=3;break;case 2:e.p=2,t=e.v,console.error("加载整理面板数据失败:",t);case 3:return e.a(2)}},e,null,[[0,2]])}),function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function i(e){Ae(a,n,o,i,l,"next",e)}function l(e){Ae(a,n,o,i,l,"throw",e)}i(void 0)})});return function(){return t.apply(this,arguments)}}(),b=function(){r({type:o.TOGGLE_ORGANIZE_PANEL,payload:!1})};return t.isOrganizePanelOpen?n.createElement("div",{className:"transition-all duration-300 ease-in-out"},n.createElement("div",{className:"grid grid-cols-2 gap-6"},n.createElement("div",{className:"card animate-fade-in"},n.createElement("h2",{className:"text-xl font-semibold text-gray-800 mb-4 sticky top-0 bg-white z-10 py-4 border-b border-gray-100"},"当前书签结构"),n.createElement("div",{className:"max-h-[600px] overflow-y-auto flex-1"},s.length>0?n.createElement(B,{bookmarks:s}):n.createElement("div",{className:"text-center py-8 text-gray-500"},n.createElement("svg",{className:"w-12 h-12 mx-auto mb-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})),"加载书签中..."))),n.createElement("div",{className:"card animate-fade-in"},n.createElement("h2",{className:"text-xl font-semibold text-gray-800 mb-4 sticky top-0 bg-white z-10 py-4 border-b border-gray-100"},"目标文件夹结构"),n.createElement("div",{className:"max-h-[600px] overflow-y-auto flex-1"},p?n.createElement(he,{template:p}):n.createElement("div",{className:"text-center py-8 text-gray-500"},n.createElement("svg",{className:"w-12 h-12 mx-auto mb-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})),n.createElement("p",null,"请先在设置中配置文件夹模板"),n.createElement("button",{onClick:function(){b(),r({type:o.TOGGLE_SETTINGS_PANEL,payload:!0})},className:"mt-2 text-blue-600 hover:text-blue-800 text-sm"},"前往设置"))))),n.createElement(Ee,null),n.createElement(Ne,{onClose:b,hasTemplate:!!p})):null};r(935);const Ie=function(){return n.createElement(y,null,n.createElement("div",{className:"bg-gray-50 min-h-screen"},n.createElement("div",{className:"container mx-auto px-4 py-8 max-w-4xl"},n.createElement(b,null),n.createElement("div",{id:"defaultView"},n.createElement(B,null)),n.createElement(_e,null),n.createElement(be,null))))};var Le=document.getElementById("options-root");(0,o.createRoot)(Le).render(n.createElement(Ie,null))},540:(e,t,r)=>{e.exports=r(869)}},r={};function n(e){var o=r[e];if(void 0!==o)return o.exports;var a=r[e]={id:e,exports:{}};return t[e](a,a.exports,n),a.exports}n.m=t,e=[],n.O=(t,r,o,a)=>{if(!r){var i=1/0;for(s=0;s<e.length;s++){for(var[r,o,a]=e[s],l=!0,c=0;c<r.length;c++)(!1&a||i>=a)&&Object.keys(n.O).every(e=>n.O[e](r[c]))?r.splice(c--,1):(l=!1,a<i&&(i=a));if(l){e.splice(s--,1);var u=o();void 0!==u&&(t=u)}}return t}a=a||0;for(var s=e.length;s>0&&e[s-1][2]>a;s--)e[s]=e[s-1];e[s]=[r,o,a]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={575:0};n.O.j=t=>0===e[t];var t=(t,r)=>{var o,a,[i,l,c]=r,u=0;if(i.some(t=>0!==e[t])){for(o in l)n.o(l,o)&&(n.m[o]=l[o]);if(c)var s=c(n)}for(t&&t(r);u<i.length;u++)a=i[u],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(s)},r=self.webpackChunkbookmark002=self.webpackChunkbookmark002||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),n.nc=void 0;var o=n.O(void 0,[333,935],()=>n(429));o=n.O(o)})();